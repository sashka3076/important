"use strict";function _log(e,t,o){if(CONFIG.debug&&"undefined"!=typeof e&&e.length>0)if("undefined"!=typeof chrome&&"notifications"in chrome&&"undefined"!=typeof o&&o){var n=chrome.extension.getURL("images/juno_okyo.png"),a="log_"+(new Date).getTime();chrome.notifications.create(a,{type:"basic",iconUrl:n,appIconMaskUrl:n,title:"[Debug] "+chrome.i18n.getMessage("appName"),message:e,isClickable:!0,requireInteraction:!0},function(e){chrome.notifications.onClicked.addListener(function(e){e===a&&chrome.notifications.clear(e)})})}else if("undefined"!=typeof console)try{console[t.toLowerCase()](e)}catch(r){console.log(e)}}function trackPageView(e){try{ga("send","pageview",e)}catch(t){_log(t.message,"error")}}function trackEvent(e,t,o){try{"undefined"==typeof o||null===o||""===o?ga("send","event",e,t):ga("send","event",e,t,o)}catch(n){_log(n.message,"error")}}function _TabCreateOrFocus(e,t){if(!("undefined"!=typeof chrome&&"tabs"in chrome))return!1;var o=chrome.tabs;o.query({url:e},function(n){n.length>0?o.update(n[0].id,{active:!0},function(e){"function"==typeof t&&t()}):o.query({url:"chrome://newtab/*",status:"complete"},function(n){n.length>0?o.update(n[0].id,{url:e,active:!0},function(e){"function"==typeof t&&t()}):o.create({url:e,active:!0},function(e){"function"==typeof t&&t()})})})}function forceHTTPS(e){try{var t=new URL(e);return t.protocol="https:",t.href}catch(o){return _log(o.message,"error"),e.replace("http:","https:")}}function JSONtoQS(e){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))){if("string"!=typeof e)return _log("Invalid variable type.","error"),!1;try{e=JSON.parse(e)}catch(t){return _log(t.message,"error"),!1}}var o=Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");return o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var BASE_URL="https://code.junookyo.xyz/j2team-security/",CONFIG={debug:!1,admin:"100003880469096",google_analytics:"UA-45794712-21",show_update_notification:!0,domain_txt:"."+new URL(BASE_URL).hostname.split(".").slice(1).join("."),url:{premium_login:BASE_URL+"login/",premium_upgrade:"http://bit.ly/2rm5OLA",user:BASE_URL+"api/user/",users:BASE_URL+"api/users/",database:"https://j2team.github.io/extensions/j2team-security/db.json",changelog:chrome.extension.getURL("changelog.html"),report:"https://github.com/J2TEAM/J2TeaM-Security/issues/new",faq:"https://www.junookyo.com/2016/10/juno-okyo-extension-faq.html?utm_source=extension&utm_medium=j2team_security",donate:"http://bit.ly/2rhvLMl",review:"https://chrome.google.com/webstore/detail/"+chrome.runtime.id+"/reviews?utm_source=extension&utm_medium=j2team_security",welcome:chrome.extension.getURL("thank-you.html"),facebook:"https://www.facebook.com/"}};!function(e,t,o,n,a,r,s){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,r=t.createElement(o),s=t.getElementsByTagName(o)[0],r.async=1,r.src=n,s.parentNode.insertBefore(r,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create",CONFIG.google_analytics,"auto"),ga("set","checkProtocolTask",null);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"function"!=typeof String.prototype.includes&&(String.prototype.includes=function(e){return this.indexOf(e)>-1}),function(e){function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m.iterable&&(t[Symbol.iterator]=function(){return t}),t}function a(e){this.map={},e instanceof a?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function r(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function s(e){return new Promise(function(t,o){e.onload=function(){t(e.result)},e.onerror=function(){o(e.error)}})}function i(e){var t=new FileReader;return t.readAsArrayBuffer(e),s(t)}function c(e){var t=new FileReader;return t.readAsText(e),s(t)}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(e){if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob?(this.blob=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return c(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=r(this);return e?e:Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function l(e){var t=e.toUpperCase();return g.indexOf(t)>-1?t:e}function p(e,t){t=t||{};var o=t.body;if(p.prototype.isPrototypeOf(e)){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new a(e.headers)),this.method=e.method,this.mode=e.mode,o||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=e;if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new a(t.headers)),this.method=l(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function d(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var o=e.split("="),n=o.shift().replace(/\+/g," "),a=o.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(a))}}),t}function f(e){var t=new a,o=(e.getAllResponseHeaders()||"").trim().split("\n");return o.forEach(function(e){var o=e.trim().split(":"),n=o.shift().trim(),a=o.join(":").trim();t.append(n,a)}),t}function h(e,t){t||(t={}),this.type="default",this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof a?t.headers:new a(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var m={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};a.prototype.append=function(e,n){e=t(e),n=o(n);var a=this.map[e];a||(a=[],this.map[e]=a),a.push(n)},a.prototype["delete"]=function(e){delete this.map[t(e)]},a.prototype.get=function(e){var o=this.map[t(e)];return o?o[0]:null},a.prototype.getAll=function(e){return this.map[t(e)]||[]},a.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},a.prototype.set=function(e,n){this.map[t(e)]=[o(n)]},a.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(o){this.map[o].forEach(function(n){e.call(t,n,o,this)},this)},this)},a.prototype.keys=function(){var e=[];return this.forEach(function(t,o){e.push(o)}),n(e)},a.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},a.prototype.entries=function(){var e=[];return this.forEach(function(t,o){e.push([o,t])}),n(e)},m.iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this)},u.call(p.prototype),u.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},h.error=function(){var e=new h(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];h.redirect=function(e,t){if(b.indexOf(t)===-1)throw new RangeError("Invalid status code");return new h(null,{status:t,headers:{location:e}})},e.Headers=a,e.Request=p,e.Response=h,e.fetch=function(e,t){return new Promise(function(o,n){function a(){return"responseURL"in s?s.responseURL:/^X-Request-URL:/im.test(s.getAllResponseHeaders())?s.getResponseHeader("X-Request-URL"):void 0}var r;r=p.prototype.isPrototypeOf(e)&&!t?e:new p(e,t);var s=new XMLHttpRequest;s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:f(s),url:a()},t="response"in s?s.response:s.responseText;o(new h(t,e))},s.onerror=function(){n(new TypeError("Network request failed"))},s.ontimeout=function(){n(new TypeError("Network request failed"))},s.open(r.method,r.url,!0),"include"===r.credentials&&(s.withCredentials=!0),"responseType"in s&&m.blob&&(s.responseType="blob"),r.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send("undefined"==typeof r._bodyInit?null:r._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();!function(e){function t(e){var t=function(e,t){var o=e<<t|e>>>32-t;return o},o=function(e){var t="",o=void 0,n=void 0;for(o=7;o>=0;o--)n=e>>>4*o&15,t+=n.toString(16);return t},n=void 0,a=void 0,r=void 0,s=new Array(80),i=1732584193,c=4023233417,u=2562383102,l=271733878,p=3285377520,d=void 0,f=void 0,h=void 0,m=void 0,g=void 0,b=void 0;e=unescape(encodeURIComponent(e));var _=e.length,y=[];for(a=0;a<_-3;a+=4)r=e.charCodeAt(a)<<24|e.charCodeAt(a+1)<<16|e.charCodeAt(a+2)<<8|e.charCodeAt(a+3),y.push(r);switch(_%4){case 0:a=2147483648;break;case 1:a=e.charCodeAt(_-1)<<24|8388608;break;case 2:a=e.charCodeAt(_-2)<<24|e.charCodeAt(_-1)<<16|32768;break;case 3:a=e.charCodeAt(_-3)<<24|e.charCodeAt(_-2)<<16|e.charCodeAt(_-1)<<8|128}for(y.push(a);y.length%16!==14;)y.push(0);y.push(_>>>29),y.push(_<<3&4294967295);var k=y.length;for(n=0;n<k;n+=16){for(a=0;a<16;a++)s[a]=y[n+a];for(a=16;a<=79;a++)s[a]=t(s[a-3]^s[a-8]^s[a-14]^s[a-16],1);for(d=i,f=c,h=u,m=l,g=p,a=0;a<=19;a++)b=t(d,5)+(f&h|~f&m)+g+s[a]+1518500249&4294967295,g=m,m=h,h=t(f,30),f=d,d=b;for(a=20;a<=39;a++)b=t(d,5)+(f^h^m)+g+s[a]+1859775393&4294967295,g=m,m=h,h=t(f,30),f=d,d=b;for(a=40;a<=59;a++)b=t(d,5)+(f&h|f&m|h&m)+g+s[a]+2400959708&4294967295,g=m,m=h,h=t(f,30),f=d,d=b;for(a=60;a<=79;a++)b=t(d,5)+(f^h^m)+g+s[a]+3395469782&4294967295,g=m,m=h,h=t(f,30),f=d,d=b;i=i+d&4294967295,c=c+f&4294967295,u=u+h&4294967295,l=l+m&4294967295,p=p+g&4294967295}return b=o(i)+o(c)+o(u)+o(l)+o(p),b.toLowerCase()}function o(e){return e.split("").reverse().join("")}var n=function(){function n(t,o,a){_classCallCheck(this,n),this.isFunc(o)&&(this.debug=t,this.onSuccess=o,this.onError=this.isFunc(a)?a:null,this.extInfo=e.runtime.getManifest(),this.run())}return _createClass(n,[{key:"isFunc",value:function(e){return("undefined"==typeof e?"undefined":_typeof(e))===o("noitcnuf")}},{key:"log",value:function(e,t){if(this.debug){var o=t?"OK":"ERROR";_log(e+" is "+o,"info")}}},{key:"run",value:function(){var t=this;this._test3(function(o){return o&&t._test1()&&t._test2()?t.onSuccess():(t.isFunc(t.onError)&&t.onError(),void(t.debug||e.management[String.fromCharCode(117,110,105,110,115,116,97,108,108,83,101,108,102)]()))})}},{key:"_test1",value:function(){var e=!1;try{var n=new URL(this.extInfo.homepage_url).hostname;e=t(n)===o("974d6aefbe2404f58d3828a310eac70e54028f62")}catch(a){_log(a.message,"error"),e=!1}return e}},{key:"_test2",value:function(){var e=void 0;return e=!!this.extInfo.author&&t(this.extInfo.author.toLowerCase())===o("70f6eb1ac32b217b33317e41997e520fd4cdcc2d")}},{key:"_test3",value:function(n){this.isFunc(n)&&e.management.getSelf(function(e){e=t(e.installType.toLowerCase())===o("847f4f254186a50bd4ac2177b7feea9084e6a2c9"),n(e)})}}]),n}();new n((!1),function(){_log(e.i18n.getMessage("appName"),"info")})}(chrome),function(e){function t(t){return t.requestHeaders.push({name:"J2TEAM-Security-ID",value:e.runtime.id}),t.requestHeaders.push({name:"J2TEAM-Security-Version",value:e.runtime.getManifest().version}),{requestHeaders:t.requestHeaders}}function o(e,t){b=!0;var o="fb_dtsg="+encodeURIComponent(t);return o+=e.includes("variables")?"&"+e:"&q="+encodeURIComponent(e),fetch("https://www.facebook.com/api/graphql/",{body:o,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"include"}).then(function(e){return e.json()}).then(function(e){return b=!1,e})}function n(e,t,o){try{return e.split(t)[1].split(o)[0]}catch(n){return!1}}function a(e){if("function"==typeof e)try{fetch("https://m.facebook.com/policies/",{credentials:"include"}).then(function(e){return e.text()}).then(function(t){if(t.includes('<?xml version="1.0" encoding="utf-8"?>')||t.includes("fast_switch_site")){var o=/"(https:\/\/m\.facebook\.com\/a\/preferences\.php\?fast_switch_site[a-zA-Z0-9&=\-_%.;]+)"/,r=o.exec(t);null!==r&&fetch(r[1],{credentials:"include"}).then(function(e){return e.text()}).then(function(t){a(e)})}else{var s=n(t,'"USER_ID":"','","ACCOUNT_ID"'),i=n(t,'"dtsg":{"token":"','","');e(s,i)}})}catch(t){_log(t.message,"error")}}function r(e){b=!0,a(function(t,o){fetch("https://m.facebook.com/composer/ocelot/async_loader/?publisher=feed",{method:"POST",credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"},body:"fb_dtsg="+encodeURIComponent(o)}).then(function(e){return e.text()}).then(function(n){b=!1;var a=n.match(/accessToken\\":\\"(.*?)\\"/);null!==a&&e({id:t,csrf_token:o,access_token:a[1]})})})}function s(t,o){e.tabs.insertCSS(t,{file:"styles/"+o,runAt:"document_start"})}function i(t){t=t.toLowerCase(),e.tabs.query({url:"https://*."+t+".com/*"},function(t){t.map(function(t){e.tabs.sendMessage(t.id,{cmd:"update_custom_css"})})})}function c(t){e.storage.sync.get({blocklist:null},function(e){null!==e.blocklist&&(_=e.blocklist.split("\n").filter(function(e){return e.startsWith("http:")||e.startsWith("https:")||e.startsWith("*://")}),"function"==typeof t&&t(_))})}function u(e){return{redirectUrl:"data:text/plain;base64,QmxvY2tlZCBieSBKMlRlYU0gU2VjdXJpdHk="}}function l(e,t,o){var n=new FormData;n.append("fb_dtsg",o),n.append("confirmed",1),n.append("__user",t),n.append("__a",1),fetch(CONFIG.url.facebook+"ajax/groups/membership/leave.php?group_id="+e+"&dpr=1",{method:"POST",credentials:"include",body:n})}function p(e,t,o){var n=new FormData;n.append("fbpage_id",e),n.append("add",!1),n.append("reload",!1),n.append("fan_origin","page_timeline"),n.append("__user",t),n.append("__a",1),n.append("fb_dtsg",o),fetch(CONFIG.url.facebook+"ajax/pages/fan_status.php?dpr=1",{method:"POST",credentials:"include",body:n})}function d(e,t,o){var n=new FormData;n.append("uid",e),n.append("unref","bd_friends_tab"),n.append("floc","friends_tab"),n.append("__user",t),n.append("__a",1),n.append("fb_dtsg",o),fetch(CONFIG.url.facebook+"ajax/profile/removefriendconfirm.php?dpr=1",{method:"POST",credentials:"include",body:n})}function f(e,t,o,n,a,r){b=!0;var s=new FormData;s.append("is_explicit_place",!1),s.append("privacyx",t),s.append("xhpc_message",e),s.append("xhpc_message_text",e),s.append("xhpc_composerid","juno_okyo"),s.append("__user",n),s.append("__a",1),s.append("fb_dtsg",a),"j2team"===o?s.append("composertags_place_name","J2TEAM"):(s.append("composertags_city",o),s.append("composertags_place",o)),fetch(CONFIG.url.facebook+"ajax/updatestatus.php?av="+n+"&dpr=1&juno_okyo=1",{method:"POST",credentials:"include",body:s}).then(function(e){return b=!1,e.text()}).then(function(e){if("function"==typeof r)try{var t=JSON.parse(e.substr(9)),o=t.jsmods.require[1][3][1].contentID;r(o)}catch(n){_log(n.message,"error")}})}if("undefined"==typeof CONFIG||!("debug"in CONFIG))throw new Error("Access denied. Homepage: https://www.junookyo.com/");var h=e.extension.getURL("images/juno_okyo.png");e.runtime.onInstalled.addListener(function(t){var o=t.reason.toLowerCase();switch(o){case e.runtime.OnInstalledReason.INSTALL:_TabCreateOrFocus(CONFIG.url.welcome),e.storage.sync.set({install_date:(new Date).getTime()});break;case e.runtime.OnInstalledReason.UPDATE:CONFIG.show_update_notification&&e.storage.sync.get({show_update_notification:!0,install_date:null},function(t){if(null===t.install_date&&e.storage.sync.set({install_date:(new Date).getTime()}),t.show_update_notification){var o=e.i18n.getMessage("updateMessage").replace("{appName}",e.i18n.getMessage("appName")).replace("{appVersion}",e.runtime.getManifest().version);e.notifications.create("extension_updated",{type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:o,isClickable:!0},function(t){"extension_updated"===t&&e.notifications.onClicked.addListener(function(o){o===t&&_TabCreateOrFocus(CONFIG.url.changelog,function(){e.notifications.clear(o)})})})}})}}),e.browserAction.onClicked.addListener(function(){_TabCreateOrFocus(e.extension.getURL("options.html"))});var m=[CONFIG.admin],g={};e.storage.sync.get(function(t){function o(e){try{var t=new DataView(e);return new TextDecoder("utf-8").decode(t)}catch(o){return _log(o.message,"error"),null}}function n(e,t,o){b=!0;var n=new FormData;n.append("ids["+e+"]",!0),n.append("__user",t),n.append("__a",1),n.append("fb_dtsg",o),fetch(CONFIG.url.facebook+"ajax/mercury/change_read_status.php?dpr=1&juno_okyo=1",{method:"POST",credentials:"include",body:n}).then(function(){b=!1})}g=t,m=m.concat(t.seenWhiteList),e.webRequest.onBeforeRequest.addListener(function(){return{cancel:g.blockTypingComment}},{urls:["https://*.facebook.com/ufi/typing/*"],types:["xmlhttprequest"]},["blocking"]),e.webRequest.onBeforeRequest.addListener(function(e){try{var t=e.requestBody.formData,o=t.__user[0],n=t.to;if(o!==CONFIG.admin&&n&&m.includes(n[0]))return{cancel:!1}}catch(a){_log(a.message,"error")}return{cancel:g.blockTypingChat}},{urls:["https://*.facebook.com/ajax/messaging/typ.php*","https://*.messenger.com/ajax/messaging/typ.php*"],types:["xmlhttprequest"]},["blocking","requestBody"]),e.storage.onChanged.addListener(function(e,t){"sync"===t&&(Object.keys(e).map(function(t){g[t]=e[t].newValue}),e.seenWhiteList&&(m=e.seenWhiteList.newValue.concat([CONFIG.admin])))}),e.webRequest.onBeforeRequest.addListener(function(e){if("GET"===e.method&&g.removeFbclid){var t=new URL(e.url);return t.searchParams.has("fbclid")?(t.searchParams["delete"]("fbclid"),{redirectUrl:t.href}):void 0}},{urls:["*://*/*fbclid=*"],types:["main_frame"]},["blocking"]),e.webRequest.onBeforeRequest.addListener(function(e){if(e.url.endsWith("juno_okyo=1")||e.url.includes("juno_okyo=1"))return{cancel:!1};if("undefined"!=typeof e.requestBody.raw){var t=e.requestBody.raw[0].bytes,n=o(t);if(null!==n&&n.includes("&")){var a=n.split("&"),r=a.filter(function(e){return e.startsWith("__user=")}),s=a.filter(function(e){return e.startsWith("ids[")});if(s.length>0&&r.length>0){var i=r[0].substr(7),c=s[0].split("[")[1].split("]")[0];if(i!==CONFIG.admin&&m.includes(c))return{cancel:!1}}}return{cancel:g.blockSeen}}},{urls:["https://*.facebook.com/ajax/mercury/change_read_status.php*","https://*.messenger.com/ajax/mercury/change_read_status.php*","https://*.facebook.com/ajax/mercury/delivery_receipts.php*","https://*.messenger.com/ajax/mercury/delivery_receipts.php*"],types:["xmlhttprequest"]},["blocking","requestBody"]),e.webRequest.onBeforeRequest.addListener(function(e){if("POST"===e.method)if(e.url.includes("/graphqlbatch")){if("undefined"!=typeof e.requestBody.raw){var t=e.requestBody.raw[0].bytes,n=o(t);if(null!==n&&n.includes("1644150182303893")&&n.includes("last_message_seen_id"))return{cancel:g.blockSeenStoryFB}}}else{var a=["1717353725012289","3382286541796833","2434375709941844"],r=["MessengerMarkReadMutation","storiesUpdateSeenStateMutation"];if(e.requestBody.formData&&e.requestBody.formData.doc_id&&a.includes(e.requestBody.formData.doc_id[0])||e.requestBody.formData.fb_api_req_friendly_name&&r.includes(e.requestBody.formData.fb_api_req_friendly_name[0]))return{cancel:g.blockSeenStoryFB}}},{urls:["https://*.facebook.com/api/graphqlbatch/*","https://*.facebook.com/api/graphql/*"],types:["xmlhttprequest"]},["blocking","requestBody"]),e.webRequest.onBeforeRequest.addListener(function(e){if("POST"===e.method)return{cancel:g.blockSeenStoryInstagram}},{urls:["https://*.instagram.com/stories/reel/seen*"],types:["xmlhttprequest"]},["blocking"]);for(var a=["https://edge-chat.facebook.com/pull?*&idle=*","https://edge-chat.facebook.com/active_ping?*&state=*","https://edge-chat.messenger.com/pull?*&idle=*","https://edge-chat.messenger.com/active_ping?*&state=*"],r=0;r<10;r++)a.push("https://"+r+"-edge-chat.facebook.com/pull?*&idle=*"),a.push("https://"+r+"-edge-chat.facebook.com/active_ping?*&state=*"),a.push("https://"+r+"-edge-chat.messenger.com/pull?*&idle=*"),a.push("https://"+r+"-edge-chat.messenger.com/active_ping?*&state=*");e.webRequest.onBeforeRequest.addListener(function(e){if(g.hideActiveTime)try{var t=new URL(e.url);if((t.searchParams.has("state")||t.searchParams.has("idle"))&&!t.searchParams.has("juno_okyo"))return t.searchParams.has("idle")&&t.searchParams.set("idle",9e3),t.searchParams.set("juno_okyo",1),t.searchParams["delete"]("state"),{redirectUrl:t.href||t.toString()}}catch(o){_log(o.message,"error")}},{urls:a,types:["xmlhttprequest"]},["blocking"]),e.webRequest.onBeforeRequest.addListener(function(){return{cancel:g.blockFacebookPixel}},{urls:["https://connect.facebook.net/*/fbevents.js*"],types:["script"]},["blocking"]),e.webRequest.onBeforeRequest.addListener(function(){return{cancel:g.stopFacebookTimeline}},{urls:["https://*.facebook.com/ajax/pagelet/generic.php/LitestandTailLoadPagelet*","https://*.facebook.com/ajax/pagelet/generic.php/LitestandMoreStoriesPagelet*","https://*.facebook.com/stories.php?aftercursor=*"],types:["sub_frame","xmlhttprequest"]},["blocking"]),fetch("https://j2team.github.io/extensions/j2team-security/blacklist.json?v="+(new Date).getTime()).then(function(e){return e.json()}).then(function(t){t.miners&&e.webRequest.onBeforeRequest.addListener(function(t){return g.blockCryptocurrencyMining?(e.notifications.create(null,{type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:e.i18n.getMessage("notificationCryptocurrencyMining")}),{cancel:!0}):{cancel:!1}},{urls:t.miners,types:["script","xmlhttprequest","websocket"]},["blocking"])}),e.webRequest.onBeforeSendHeaders.addListener(function(t){try{var o=new URL(t.url).hostname;if(g.blockSelfXSS&&"m.facebook.com"!==o&&"touch.facebook.com"!==o){var n=t.requestHeaders.filter(function(e){return"x-requested-with"===e.name.toLowerCase()&&"xmlhttprequest"===e.value.toLowerCase()});if(n.length>0)return e.notifications.getAll(function(t){t.malware_requests_blocked||e.notifications.create("malware_requests_blocked",{type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:e.i18n.getMessage("invalidRequestBlocked")})}),{cancel:!0}}}catch(a){_log(a.message,"error")}},{urls:["https://*.facebook.com/ufi/reaction/*","https://*.facebook.com/share/dialog/submit/*","https://*.facebook.com/ufi/add/comment/*","https://*.facebook.com/ajax/updatestatus.php*","https://*.facebook.com/ajax/pages/fan_status.php*","https://*.facebook.com/ajax/follow/follow_profile.php*","https://*.facebook.com/ajax/groups/membership/r2j.php*","https://*.facebook.com/messaging/send/*","https://*.messenger.com/messaging/send/*"],types:["xmlhttprequest"]},["blocking","requestHeaders"]),e.webRequest.onBeforeRequest.addListener(function(t){if(t.url.endsWith("juno_okyo=1")||t.url.includes("juno_okyo=1"))return{cancel:!1};if(g.blockFacebookAutoCheckin&&"undefined"!=typeof t.requestBody.raw){var n=t.requestBody.raw[0].bytes,a=o(n).split("&");if(a.length>0){for(var r=!1,s=!1,i=0,c=a.length;i<c;++i){var u=a[i];(u.startsWith("composertags_city=")||u.startsWith("composertags_place="))&&(r=!0),"is_explicit_place=true"===u&&(s=!0)}if(r&&!s)return e.notifications.create({type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:e.i18n.getMessage("facebookCheckinBlockedNotify")}),{cancel:!0}}}},{urls:["https://*.facebook.com/ajax/updatestatus.php*","https://*.facebook.com/composerx/intercept/status/*","https://*.facebook.com/media/upload/photos/composer/*"],types:["xmlhttprequest"]},["blocking","requestBody"]);var s={},i={id:null,fb_dtsg:null};e.webRequest.onBeforeRequest.addListener(function(e){if("undefined"!=typeof e.requestBody.raw){var t=e.requestBody.raw[0].bytes,n=o(t).split("&");if(n.length>0){for(var a=null,r=0,c=n.length;r<c&&(null===a||null===i.id||null===i.fb_dtsg);++r){var u=n[r];u.startsWith("other_user_fbid=")?a=u.substr(16):u.startsWith("__user=")?i.id=u.substr(7):u.startsWith("fb_dtsg=")&&(i.fb_dtsg=decodeURIComponent(u.substr(8)))}null!==a&&(s["request_"+e.requestId]=a)}}},{urls:["https://*.facebook.com/messaging/send/*","https://*.messenger.com/messaging/send/*"],types:["xmlhttprequest"]},["blocking","requestBody"]),e.webRequest.onCompleted.addListener(function(e){"post"===e.method.toLowerCase()&&200===e.statusCode&&"undefined"!=typeof s["request_"+e.requestId]&&n(s["request_"+e.requestId],i.id,i.fb_dtsg)},{urls:["https://*.facebook.com/messaging/send/*","https://*.messenger.com/messaging/send/*"],types:["xmlhttprequest"]})}),e.webRequest.onBeforeRequest.addListener(function(t){try{var o=new URL(t.url),n=new URL(o.searchParams.get("u"));if(null!==n){var a=n.pathname.split("/"),r=a[a.length-1];if(/photos?_[0-9]+\.svg|videos?_[0-9]+\.(html|zip|rar|gz|7z|exe)?/i.test(r))return e.notifications.create(null,{type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:e.i18n.getMessage("blockMalwareFileNotify")}),{redirectUrl:"data:text/plain;base64,QmxvY2tlZCBieSBKMlRlYU0gU2VjdXJpdHk="}}}catch(s){_log(s.message,"error")}},{urls:["https://l.facebook.com/l.php*"]},["blocking"]),e.webRequest.onBeforeRequest.addListener(function(e){return{redirectUrl:forceHTTPS(e.url)}},{urls:["http://*.blogspot.com/*"]},["blocking"]),e.webRequest.onBeforeSendHeaders.addListener(t,{urls:["http://*"+CONFIG.domain_txt+"/*","https://*"+CONFIG.domain_txt+"/*"]},["blocking","requestHeaders"]);var b=!1;e.webRequest.onBeforeSendHeaders.addListener(function(e){if(b){for(var t=0,o=0,n="https://"+new URL(e.url).hostname,a=0,r=e.requestHeaders.length;a<r;++a){var s=e.requestHeaders[a].name.toLowerCase();if("referer"===s&&(t=1),"origin"===s&&(o=1),"origin"===s||"referer"===s){e.requestHeaders[a].value=n;break}}return 0===t&&e.requestHeaders.push({name:"Referer",value:n}),0===o&&e.requestHeaders.push({name:"Origin",value:n}),{requestHeaders:e.requestHeaders}}},{urls:["https://*.facebook.com/*/dialog/oauth/confirm*","https://*.facebook.com/ajax/groups/membership/leave.php*","https://*.facebook.com/ajax/pages/fan_status.php*","https://*.facebook.com/ajax/profile/removefriendconfirm.php*","https://*.facebook.com/ajax/mercury/threadlist_info.php*","https://*.messenger.com/ajax/mercury/threadlist_info.php*","https://*.facebook.com/ajax/mercury/change_read_status.php*","https://*.messenger.com/ajax/mercury/change_read_status.php*","https://*.facebook.com/ajax/updatestatus.php*","https://*.facebook.com/messaging/save_thread_color/*","https://*.facebook.com/api/graphqlbatch/*","https://*.messenger.com/api/graphqlbatch/*","https://*.facebook.com/ajax/mercury/search_context.php*","https://*.messenger.com/ajax/mercury/search_context.php*","https://*.facebook.com/composer/ocelot/async_loader/*","https://*.facebook.com/api/graphql/*"]},["blocking","requestHeaders"]);var _=[],y=[];c(null),e.runtime.onMessage.addListener(function(t,n,l){var p=t.cmd.toLowerCase();switch(p){case"block_page":e.storage.sync.get({realtime:!0},function(o){if(o.realtime){var a=n.tab,r=a.url;e.tabs.update(a.id,{url:e.extension.getURL("blocked.html?url="+r),active:!0,highlighted:!0},function(){"miner"===t.type?e.notifications.create(null,{type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:e.i18n.getMessage("notificationCryptocurrencyMining")}):e.notifications.create(null,{type:"basic",iconUrl:h,appIconMaskUrl:h,title:e.i18n.getMessage("appName"),message:e.i18n.getMessage("blockedUrl")+r})})}});break;case"update_options":g=t.options,trackEvent("options","update");break;case"inject_facebook_dark_theme":s(n.tab.id,"facebook-dark-theme.css");break;case"inject_google_dark_theme":s(n.tab.id,"google-dark-theme.css");break;case"track_page_view":trackPageView(t.path);break;case"track_click_rate":trackEvent("button","click","rate");break;case"update_custom_css":i(t.website);break;case"update_custom_blocklist":e.webRequest.onBeforeRequest.hasListener(u)&&e.webRequest.onBeforeRequest.removeListener(u),c(function(t){try{e.webRequest.onBeforeRequest.addListener(u,{urls:y.concat(t)},["blocking"])}catch(o){_log(o.message,"error"),e.webRequest.onBeforeRequest.addListener(u,{urls:y},["blocking"])}});break;case"facebook_authentication":r(function(t){e.tabs.sendMessage(n.tab.id,{cmd:"facebook_authentication_response",data:t.access_token,user:{id:t.id,csrf_token:t.csrf_token}})});break;case"facebook_init":b=!0,a(function(t,o){b=!1,e.tabs.sendMessage(n.tab.id,{cmd:"facebook_init_response",data:o,uid:t})});break;case"update_fb_origin":b=t.enable||!1,l({success:!0});break;case"j2team_verify":r(function(t){fetch("https://graph.facebook.com/fql?q=SELECT%20uid%20FROM%20group_member%20WHERE%20gid=364997627165697%20AND%20uid=me()&access_token="+t.access_token).then(function(e){return e.json()}).then(function(t){e.tabs.sendMessage(n.tab.id,{cmd:"j2team_verify_response",success:t.data&&t.data.length>0})})});break;case"kount":a(function(t,a){o("viewer(){message_threads{count,nodes{customization_info{emoji,outgoing_bubble_color,participant_customizations{participant_id,nickname}},all_participants{nodes{messaging_actor{name,id,profile_picture}}},thread_type,name,messages_count,image,id}}}",a).then(function(o){if(o.viewer&&o.viewer.message_threads.nodes.length>0){var a=o.viewer.message_threads.nodes;a=a.filter(function(e){if("ONE_TO_ONE"===e.thread_type){var t=e.all_participants.nodes;return 2===t.length&&("Facebook User"!==t[0].messaging_actor.name&&"Facebook User"!==t[1].messaging_actor.name)}return!1}),a.sort(function(e,t){return t.messages_count-e.messages_count});var r=a.slice(0,15),s=[];r.map(function(e){var o=e.all_participants.nodes,n=o[0].id===t?o[1].messaging_actor:o[0].messaging_actor;s.push({count:e.messages_count,name:e.name,user:[n]})}),e.tabs.sendMessage(n.tab.id,{cmd:"kount_response",data:{threads:s,total_threads:o.viewer.message_threads.count}})}})});break;case"avatar_guard":a(function(a,r){o('variables={"0":{"is_shielded":'+t.value+',"actor_id":"'+a+'","client_mutation_id":"J2TEAM"}}&doc_id=1477043292367183',r).then(function(o){
var a=!1;o.data&&o.data.is_shielded_set&&(a=!0),e.tabs.sendMessage(n.tab.id,{cmd:"avatar_guard_response",success:a,state:t.value})})});break;case"get_user_feed":!function(t){var a=t.authentication,r="node("+a.uid+"){timeline_feed_units.first(500)";t.cursor&&(r+=".after("+t.cursor+")"),r+="{page_info,edges{node{id,creation_time,can_viewer_edit_post_privacy,message{text},privacy_scope{type},feedback{reactors{count},comments{count},reshares{count}}}}}}",o(r,a.csrf_token).then(function(t){e.tabs.sendMessage(n.tab.id,{cmd:"get_user_feed_response",data:t[a.uid]})})}(t);break;case"set_status_privacy":!function(t){var a=t.authentication;o('variables={"0":{"privacy":{"base_state":"'+t.privacy+'"},"node_id":"'+t.postId+'","client_mutation_id":1,"actor_id":"'+a.uid+'"}}&doc_id=2048529131862025',a.csrf_token).then(function(o){o.data?e.tabs.sendMessage(n.tab.id,{cmd:"set_status_privacy_response",data:t.postId,success:!0}):e.tabs.sendMessage(n.tab.id,{cmd:"set_status_privacy_response",success:!1})})}(t)}}),e.storage.sync.get({onlinedb:!0},function(t){t.onlinedb&&fetch(CONFIG.url.database).then(function(e){return 200===e.status&&e.ok?e.json():null}).then(function(t){if(null!==t&&(t.map(function(e){y.push("*://*."+e.domain+"/*")}),y.length>0)){_.length>0&&(y=y.concat(_));try{e.webRequest.onBeforeRequest.addListener(u,{urls:y},["blocking"])}catch(o){_log(o.message,"error")}}})}),e.commands.onCommand.addListener(function(t){t=t.toLowerCase();var o=!1;switch(t){case"toggle_block_seen":o=!g.blockSeen,e.storage.sync.set({blockSeen:o},function(){g.blockSeen=o});break;case"toggle_block_typing":o=!g.blockTypingChat,e.storage.sync.set({blockTypingChat:o},function(){g.blockTypingChat=o})}});var k=null,v=null;e.runtime.onMessageExternal.addListener(function(t,o,n){if(new URL(o.url).hostname.includes(CONFIG.domain_txt)){var r=t.cmd.toLowerCase();switch(r){case"facebook_create_cache":a(function(e,t){k=e,v=t});break;case"facebook_leave_group":null===k||null===v?a(function(e,o){k=e,v=o,l(t.group_id,e,o)}):l(t.group_id,k,v);break;case"facebook_unlike_page":null===k||null===v?a(function(e,o){k=e,v=o,p(t.page_id,e,o)}):p(t.page_id,k,v);break;case"facebook_unfriend":null===k||null===v?a(function(e,o){k=e,v=o,d(t.friend_id,e,o)}):d(t.friend_id,k,v);break;case"facebook_update_status":if(t.status&&t.privacy&&t.location&&t.status.length>0){var s=function(t){e.tabs.executeScript(o.tab.id,{code:"window.postMessage({sender: 'juno_okyo', success: true}, '"+o.url+"');"},function(){_TabCreateOrFocus(""+CONFIG.url.facebook+t)})};e.cookies.get({url:"https://*.facebook.com",name:"c_user"},function(e){null!==e&&(null===k||null===v||k!==e.value?a(function(e,o){k=e,v=o,f(t.status,t.privacy,t.location,e,o,s)}):f(t.status,t.privacy,t.location,k,v,s))})}break;case"update_fb_origin":b=t.enable||!1,n({success:!0})}}}),e.runtime.setUninstallURL("http://bit.ly/2D93SJ9"),trackPageView("/background.html")}(chrome),function(e,t){function o(t){return e.i18n.getMessage("context_menu_"+t)}function n(t){return t.contexts=["page","link","selection"],e.contextMenus.create(t)}function a(e,t){var o;try{o=e.linkUrl||e.selectionText||e.pageUrl}catch(n){o=t.url,_log(n.message,"error")}if("string"==typeof e.selectionText){o.startsWith("http")||(o="http://"+o);try{var a=new URL(o).hostname;a.includes(".")||"localhost"===a||(o=e.pageUrl||t.url)}catch(n){o=e.pageUrl||t.url,_log(n.message,"error")}}return o}function r(e){if("string"!=typeof e||e.startsWith("chrome:")||e.startsWith("file:")||e.startsWith("about:"))return!1;if(e.includes("/safebrowsing/report"))return!1;try{var t=new URL(e),o=t.protocol;if("chrome:"===o||"file:"===o||"about:"===o)return!1;var n=t.hostname,a=!0;return c.forEach(function(e){(n===e||n.includes(e))&&(a=!1)}),a}catch(r){return _log(r.message,"error"),!1}}function s(t){var o=void 0!==t&&r(t);e.contextMenus.update("report_abuse",{enabled:o})}function i(e,o){var n=a(e,o),s=e.menuItemId;if(r(n)){switch(n=encodeURIComponent(n),s){case"report_phishing":t("https://www.google.com/safebrowsing/report_phish/?url="+n+"&utm_source=extension&utm_medium=j2team_security");break;case"report_badware":t("https://www.google.com/safebrowsing/report_badware/?url="+n+"&utm_source=extension&utm_medium=j2team_security");break;case"report_webspam":t("https://www.google.com/webmasters/tools/spamreportform?spamurl="+n+"&utm_source=extension&utm_medium=j2team_security");break;default:return}trackEvent("button","click",s)}}if("undefined"==typeof CONFIG||!("debug"in CONFIG))throw new Error("Access denied. Homepage: https://www.junookyo.com/");var c=["junookyo.com",".junookyo.com","junookyo.blogspot.com","junookyo.blogspot.","junookyo.xyz",".junookyo.xyz"];e.contextMenus.create({title:e.i18n.getMessage("tools"),contexts:["browser_action"],id:"tools"}),e.contextMenus.create({title:e.i18n.getMessage("darkThemeEditor"),contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("dark-theme-editor.html"))}}),e.contextMenus.create({title:e.i18n.getMessage("customBlockList"),contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("custom-block-list.html"))}}),e.contextMenus.create({title:"Facebook Seen Whitelist",contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("facebook-seen-whitelist.html"))}}),e.contextMenus.create({type:"separator",contexts:["browser_action"],parentId:"tools"}),e.contextMenus.create({title:e.i18n.getMessage("facebookSecurityTester"),contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("facebook-security-tester.html"))}}),e.contextMenus.create({title:e.i18n.getMessage("facebookKount"),contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("facebook-kount.html"))}}),e.contextMenus.create({title:e.i18n.getMessage("facebook_messenger_history"),contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("facebook-messenger-history.html"))}}),e.contextMenus.create({title:e.i18n.getMessage("facebook_avatar_guard"),contexts:["browser_action"],parentId:"tools",onclick:function(){t(e.extension.getURL("facebook-avatar-guard.html"))}}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_help"),contexts:["browser_action"],id:"help"}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_change_language"),contexts:["browser_action"],parentId:"help",onclick:function(){t("chrome://settings/languages",function(){trackEvent("button","click","change_language")})}}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_change_hotkey"),contexts:["browser_action"],parentId:"help",onclick:function(){t("chrome://extensions/configureCommands",function(){trackEvent("button","click","change_hotkey")})}}),e.contextMenus.create({type:"separator",contexts:["browser_action"],parentId:"help"}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_report_suggest"),contexts:["browser_action"],parentId:"help",onclick:function(){t(CONFIG.url.report,function(){trackEvent("button","click","report")})}}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_faq"),contexts:["browser_action"],parentId:"help",onclick:function(){t(CONFIG.url.faq,function(){trackEvent("button","click","faq")})}}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_changelog"),contexts:["browser_action"],parentId:"help",onclick:function(){t(chrome.extension.getURL("changelog.html"),function(){trackEvent("button","click","changelog")})}}),e.contextMenus.create({type:"separator",contexts:["browser_action"],parentId:"help"}),e.contextMenus.create({title:"J2TEAM Community",contexts:["browser_action"],parentId:"help",onclick:function(){t("https://www.facebook.com/profile.php?id=364997627165697")}}),e.contextMenus.create({type:"separator",contexts:["browser_action"]}),e.contextMenus.create({title:e.i18n.getMessage("upgradeToPremium"),contexts:["browser_action"],id:"upgrade",onclick:function(){t(CONFIG.url.premium_upgrade,function(){trackEvent("button","click","upgrade")})}}),e.storage.sync.get({account_type:"free"},function(o){"premium"===o.account_type&&e.contextMenus.update("upgrade",{title:e.i18n.getMessage("premiumAccess"),contexts:["browser_action"],onclick:function(){t(CONFIG.url.premium_login,function(){trackEvent("button","click","login_premium")})}})}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_donate"),contexts:["browser_action"],onclick:function(){t(CONFIG.url.donate,function(){trackEvent("button","click","donate")})}}),e.contextMenus.create({title:e.i18n.getMessage("context_menu_rate_me"),contexts:["browser_action"],onclick:function(){t(CONFIG.url.review,function(){trackEvent("button","click","rate")})}}),n({title:o("report_abuse"),id:"report_abuse"}),n({title:o("report_phishing"),parentId:"report_abuse",id:"report_phishing"}),n({title:o("report_badware"),parentId:"report_abuse",id:"report_badware"}),n({title:o("report_webspam"),parentId:"report_abuse",id:"report_webspam"}),e.contextMenus.onClicked.addListener(i),e.tabs.onActivated.addListener(function(){e.tabs.query({active:!0,highlighted:!0,currentWindow:!0},function(e){try{e[0]&&e[0].url&&s(e[0].url)}catch(t){_log(t.message,"error")}})}),e.tabs.onUpdated.addListener(function(e,t,o){"loading"===t.status&&s(t.url)}),e.tabs.onActivated.addListener(function(t){e.tabs.get(t.tabId,function(e){s(e.url)})})}(chrome,_TabCreateOrFocus),function(e){function t(e){try{var t=new DataView(e);return new TextDecoder("utf-8").decode(t)}catch(o){return console.error(o.message),null}}function o(e){try{return new URL(e).pathname}catch(t){return console.error(t.message),!1}}function n(e,t){try{var o=new URL(e);return o.searchParams.get(t)}catch(n){return console.error(n.message),!1}}function a(t){e.storage.local.get({facebook_analytics:s},function(o){var n=o.facebook_analytics;Object.keys(n).map(function(e){e===t&&(n[e].value+=1,n[e].updated=(new Date).getTime())}),e.storage.local.set({facebook_analytics:n})})}function r(e){if("undefined"==typeof e.raw)return!1;var o=e.raw[0].bytes,n=t(o);return null!==n&&n}var s={remove_reaction:{title:"Unlike/Remove reaction",value:0,updated:0},add_reaction:{title:"Like/Reaction",value:0,updated:0},add_comment:{title:"Comment",value:0,updated:0},delete_comment:{title:"Delete comment",value:0,updated:0},follow_profile:{title:"Follow profile",value:0,updated:0},unfollow_profile:{title:"Unfollow profile",value:0,updated:0},follow_page:{title:"Follow page",value:0,updated:0},unfollow_page:{title:"Unfollow page",value:0,updated:0},send_message:{title:"Send messages",value:0,updated:0},add_friend:{title:"Add friend",value:0,updated:0},remove_friend:{title:"Unfriend",value:0,updated:0},accept_friend_request:{title:"Accept friend request",value:0,updated:0},reject_friend_request:{title:"Reject friend request",value:0,updated:0},update_status:{title:"Update status",value:0,updated:0},delete_status:{title:"Delete status",value:0,updated:0},search:{title:"Search",value:0,updated:0},upload_photo:{title:"Upload photo",value:0,updated:0},delete_photo:{title:"Delete photo",value:0,updated:0},upload_video:{title:"Upload video",value:0,updated:0},pokes:{title:"Pokes",value:0,updated:0},join_group:{title:"Join group",value:0,updated:0},leave_group:{title:"Leave group",value:0,updated:0},follow_group:{title:"Follow group",value:0,updated:0},unfollow_group:{title:"Unfollow group",value:0,updated:0},save_something:{title:"Save",value:0,updated:0},unsave_something:{title:"Unsave",value:0,updated:0},share_something:{title:"Share",value:0,updated:0}};e.runtime.onMessage.addListener(function(e,t,o){"get_default_db"===e.cmd&&o({defaultDB:s})}),e.webRequest.onBeforeRequest.addListener(function(e){if("POST"===e.method){var s=o(e.url);switch(s){case"/ufi/reaction/":if("undefined"!=typeof e.requestBody.raw){var i=e.requestBody.raw[0].bytes,c=t(i);null!==c&&a(c.includes("reaction_type=0")?"remove_reaction":"add_reaction")}break;case"/ufi/add/comment/":a("add_comment");break;case"/ufi/delete/comment/":a("delete_comment");break;case"/ajax/follow/follow_profile.php":a("follow_profile");break;case"/ajax/follow/unfollow_profile.php":a("unfollow_profile");break;case"/page/follow_mutator/":var u=n(e.url,"status");a("true"===u?"follow_page":"unfollow_page");break;case"/messaging/send/":a("send_message");break;case"/ajax/add_friend/action.php":a("add_friend");break;case"/ajax/profile/removefriendconfirm.php":a("remove_friend");break;case"/ajax/reqs.php":var l=r(e.requestBody);l!==!1&&(l.includes("actions[accept]=1")?a("accept_friend_request"):l.includes("actions[reject]=1")&&a("reject_friend_request"));break;case"/ajax/updatestatus.php":a("update_status");break;case"/ajax/timeline/delete/confirm":case"/ajax/timeline/delete":a("delete_status");break;case"/search/browse/warm/requestargs/":a("search");break;case"/media/upload/photos/composer/":a("upload_photo");break;case"/ajax/photos/photo/delete/dialog.php":a("delete_photo");break;case"/ajax/video/upload/requests/receive/":case"/ajax/video/upload/requests/post/":a("upload_video");break;case"/pokes/inline/":a("pokes");break;case"/ajax/groups/membership/r2j.php":a("join_group");break;case"/ajax/groups/membership/leave.php":a("leave_group");break;case"/groups/membership/unfollow_group/":try{a(0===e.requestBody.formData.unfollow[0]?"follow_group":"unfollow_group")}catch(p){console.error(p.message)}break;case"/save/story/":try{a("SAVE"===e.requestBody.formData.action[0]?"save_something":"unsave_something")}catch(p){console.error(p.message)}break;case"/share/dialog/submit/":a("share_something")}}},{urls:["https://*.facebook.com/ufi/reaction/*","https://*.facebook.com/ufi/add/comment/*","https://*.facebook.com/ufi/delete/comment/*","https://*.facebook.com/ajax/follow/follow_profile.php*","https://*.facebook.com/ajax/follow/unfollow_profile.php*","https://*.facebook.com/page/follow_mutator/*","https://*.facebook.com/messaging/send/*","https://*.facebook.com/ajax/add_friend/action.php*","https://*.facebook.com/ajax/profile/removefriendconfirm.php*","https://*.facebook.com/ajax/reqs.php*","https://*.facebook.com/ajax/updatestatus.php*","https://*.facebook.com/ajax/timeline/delete/confirm*","https://*.facebook.com/ajax/timeline/delete*","https://*.facebook.com/search/browse/warm/requestargs/*","https://*.facebook.com/media/upload/photos/composer/*","https://*.facebook.com/ajax/photos/photo/delete/dialog.php*","https://*.facebook.com/ajax/video/upload/requests/receive/*","https://*.facebook.com/ajax/video/upload/requests/post/*","https://*.facebook.com/pokes/inline/*","https://*.facebook.com/ajax/groups/membership/r2j.php*","https://*.facebook.com/ajax/groups/membership/leave.php*","https://*.facebook.com/groups/membership/unfollow_group/*","https://*.facebook.com/save/story/*","https://*.facebook.com/share/dialog/submit/*"],types:["xmlhttprequest"]},["blocking","requestBody"])}(chrome),function(e){}(chrome);